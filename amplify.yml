version: 1
frontend:
  customHeaders:
    - pattern: '**/*'
      headers:
        - key: 'Strict-Transport-Security'
          value: 'max-age=63072000; includeSubDomains; preload'
        - key: 'X-Content-Type-Options'
          value: 'nosniff'
        - key: 'Referrer-Policy'
          value: 'strict-origin-when-cross-origin'
        - key: 'Permissions-Policy'
          value: 'geolocation=(), microphone=(), camera=()'
        # CSP needs to match your real external dependencies.
        # This is a conservative baseline for a Vite React SPA that loads Google Fonts.
        - key: 'Content-Security-Policy'
          value: "default-src 'self'; base-uri 'self'; object-src 'none'; frame-ancestors 'none'; form-action 'self'; img-src 'self' data: https:; font-src 'self' https://fonts.gstatic.com data:; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; script-src 'self'; connect-src 'self' https://api.github.com https:; media-src 'self' blob:; upgrade-insecure-requests"
  phases:
    preBuild:
      commands:
        - nvm install 20.19.0
        - nvm use 20.19.0
        - nvm alias default 20.19.0
        - node --version
        - npm --version
        - npm ci --cache .npm --prefer-offline
    build:
      commands:
        - nvm use 20.19.0
        - npm run build
  artifacts:
    baseDirectory: dist
    files:
      - '**/*'
  cache:
    paths:
      - .npm/**/*
      - node_modules/**/*
